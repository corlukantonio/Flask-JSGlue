language: python

matrix:
  include:
    - python: 2.7
      env: TOXENV=py27
    - python: 3.3
      env: TOXENV=py33
    - python: 3.4
      env: TOXENV=py34
    - python: 3.5
      env: TOXENV=py35
    - python: 3.6
      env: TOXENV=py36
    - python: pypy
      env: TOXENV=pypy
    - python: pypy3
      env: TOXENV=pypy3

services:
  - docker

install:
  - if [[ $TRAVIS_PYTHON_VERSION == 2.7 ]]; then
    pip install "flask<=1.0.4";
    elif [[ $TRAVIS_PYTHON_VERSION == 3.3 ]]; then
    docker build -t my_custom_python33 .travis/;
    else
    pip install flask;
    fi

script:
  - if [[ $TRAVIS_PYTHON_VERSION == 3.3 ]]; then
    docker run --rm -v $PWD:/app -w /app my_custom_python33 python test.py;
    else
    python test.py;
    fi
